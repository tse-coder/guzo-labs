<!-- UsersPage Component -->
<!-- Purpose: Displays user list -->
<% layout('layouts/main') -%>
<% page = 'users' %>
<div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md">
    <h2 class="text-2xl font-semibold mb-4 text-gray-900 dark:text-white">Manage Users</h2>
    <div class="overflow-x-auto">
        <table class="w-full text-left">
            <thead>
                <tr class="bg-gray-50 dark:bg-gray-700">
                    <th class="p-3 font-bold text-gray-900 dark:text-white">ID</th>
                    <th class="p-3 font-bold text-gray-900 dark:text-white">Name</th>
                    <th class="p-3 font-bold text-gray-900 dark:text-white">Email</th>
                    <th class="p-3 font-bold text-gray-900 dark:text-white">Points</th>
                    <th class="p-3 font-bold text-gray-900 dark:text-white">Tier</th>
                    <th class="p-3 font-bold text-gray-900 dark:text-white">Tasks</th>
                    <th class="p-3 font-bold text-gray-900 dark:text-white">Actions</th>
                </tr>
            </thead>
            <tbody>
                <% users.forEach(user => { %>
                    <tr class="hover:bg-gray-100 dark:hover:bg-gray-700">
                        <td class="p-3 text-gray-900 dark:text-white"><%= user._id %></td>
                        <td class="p-3 text-gray-900 dark:text-white"><%= user.name %></td>
                        <td class="p-3 text-gray-900 dark:text-white"><%= user.email %></td>
                        <td class="p-3 text-gray-900 dark:text-white"><%= user.points %></td>
                        <td class="p-3 text-gray-900 dark:text-white"><%= user.currentTier.name %></td>
                        <td class="p-3 text-gray-900 dark:text-white">
                            <%= user.tasks.map(t => `${t.taskId.name}: ${t.status}`).join(', ') || 'None' %>
                        </td>
                        <td class="p-3">
                            <form action="/users/delete/<%= user._id %>" method="POST">
                                <button type="submit" class="bg-red-500 text-white px-3 py-1 rounded-md hover:bg-red-600">Delete</button>
                            </form>
                        </td>
                    </tr>
                <% }) %>
            </tbody>
        </table>
    </div>
</div>